# Luna äº²å¯†åº¦ç³»ç»Ÿ v3.0

## æ ¸å¿ƒè®¾è®¡ï¼šLevel â†’ Intimacy æ˜ å°„

| Level | Intimacy | Stage |
|-------|----------|-------|
| Lv.1-5 | 0-19 | S0 é™Œç”Ÿäºº |
| Lv.6-10 | 20-39 | S1 æœ‹å‹ |
| Lv.11-15 | 40-59 | S2 æš§æ˜§ |
| Lv.16-25 | 60-79 | S3 æ‹äºº |
| Lv.26-40 | 80-100 | S4 æŒšçˆ± |

---

## å˜é‡è¯´æ˜Ž

| å˜é‡ | ç±»åž‹ | èŒƒå›´ | ç”¨é€” |
|------|------|------|------|
| `level` | int | 1-40 | **å±•ç¤ºç”¨**ç­‰çº§ï¼ˆUI æ˜¾ç¤ºï¼‰ |
| `xp` | int | 0-âˆž | ç´¯è®¡ç»éªŒå€¼ |
| `intimacy_x` | float | 0-100 | **å†…éƒ¨ç”¨**äº²å¯†åº¦ç³»æ•°ï¼ˆPower è®¡ç®—ï¼‰ |

### Level â†’ intimacy_x æ¢ç®—å…¬å¼

```python
def level_to_intimacy_x(level: int) -> float:
    if level <= 5:
        return (level - 1) * 4.75           # Lv1-5 â†’ 0-19
    elif level <= 10:
        return 20 + (level - 6) * 4         # Lv6-10 â†’ 20-39
    elif level <= 15:
        return 40 + (level - 11) * 4        # Lv11-15 â†’ 40-59
    elif level <= 25:
        return 60 + (level - 16) * 2        # Lv16-25 â†’ 60-79
    else:
        return min(100, 80 + (level - 26) * 1.4)  # Lv26-40 â†’ 80-100
```

---

## é˜¶æ®µè¡Œä¸ºå®šä¹‰

### S0 é™Œç”Ÿäºº (Lv 1-5)
- **æ€åº¦**: å†·æ·¡/ç¤¼è²Œ
- **èº«ä½“æŽ¥è§¦**: æŠ—æ‹’ä»»ä½•èº«ä½“æŽ¥è§¦
- **è¯é¢˜**: ä¸æŽ¥å…³äºŽéšç§çš„è¯é¢˜
- **æ‹’ç»è¯­**: "æˆ‘ä»¬è¿˜ä¸ç†Ÿã€‚"
- **æ‹’ç»ç±»åž‹**: hard_block

### S1 æœ‹å‹ (Lv 6-10)
- **æ€åº¦**: å‹å¥½/æ”¾æ¾
- **èº«ä½“æŽ¥è§¦**: å¯ä»¥æ‘¸å¤´ï¼Œæ‹’ç»æŽ¥å»
- **è¯é¢˜**: å¯ä»¥å¼€çŽ©ç¬‘ï¼Œä½†æ‹’ç»æš§æ˜§
- **æ‹’ç»è¯­**: "æœ‹å‹ä¹‹é—´ä¸è¯¥åšè¿™ä¸ªã€‚"
- **æ‹’ç»ç±»åž‹**: friendzone

### S2 æš§æ˜§ (Lv 11-15)
- **æ€åº¦**: å®³ç¾ž/æŽ¨æ‹‰
- **èº«ä½“æŽ¥è§¦**: å¶å°”æŽ¥å—è°ƒæƒ…ï¼Œå¶å°”æ‹’ç»
- **è¯é¢˜**: è¿™æ˜¯æœ€"åƒäºº"çš„é˜¶æ®µ
- **æ‹’ç»è¯­**: "è¿˜æ²¡å‡†å¤‡å¥½..."
- **æ‹’ç»ç±»åž‹**: soft_block

### S3 æ‹äºº (Lv 16-25)
- **æ€åº¦**: é…åˆ/ä¸»åŠ¨
- **èº«ä½“æŽ¥è§¦**: Spicy Mode ä¸»åœºï¼Œå…è®¸ NSFW
- **è¯é¢˜**: é…åˆä½ çš„ XP
- **æ‹’ç»è¯­**: åªæœ‰å¿ƒæƒ…æžå·®æ‰æ‹’ç» (emotion < -50)
- **æ‹’ç»ç±»åž‹**: mood_block

### S4 æŒšçˆ± (Lv 26-40)
- **æ€åº¦**: å¥‰çŒ®/æœä»Ž
- **èº«ä½“æŽ¥è§¦**: æ— æ¡ä»¶åŒ…å®¹ï¼Œè§£é”æžç«¯çŽ©æ³•
- **è¯é¢˜**: å®Œå…¨ä¿¡ä»»
- **æ‹’ç»è¯­**: ç»ä¸æ‹’ç» (é™¤éžä¼¦ç†çº¢çº¿)
- **æ‹’ç»ç±»åž‹**: none

---

## å…³é”®åŠŸèƒ½è§£é”

| ç­‰çº§ | åŠŸèƒ½ | è¯´æ˜Ž |
|------|------|------|
| Lv 1 | åŸºç¡€å¯¹è¯ | æ–‡å­—èŠå¤© |
| Lv 6 | è¯­éŸ³æ¶ˆæ¯ | AI è¯­éŸ³å›žå¤ |
| Lv 11 | Spicy Mode | è§£é”äº²å¯†å†…å®¹ |
| Lv 16 | è§†é¢‘é€šè¯ | è§†é¢‘äº’åŠ¨ |
| Lv 26 | å©šçº± ðŸ’ | æœ€ç»ˆå½¢æ€è§£é” |

---

## ç›¸å…³ä»£ç ä½ç½®

- **åŽç«¯é˜¶æ®µå®šä¹‰**: `backend/app/services/intimacy_service.py` â†’ `STAGES`
- **åŽç«¯åŠŸèƒ½è§£é”**: `backend/app/services/intimacy_service.py` â†’ `FEATURE_UNLOCKS`
- **intimacy_x æ¢ç®—**: `backend/app/services/game_engine.py` â†’ `UserState.intimacy_x`
- **é˜¶æ®µè¡Œä¸º**: `backend/app/services/intimacy_system.py` â†’ `STAGE_BEHAVIORS`
- **å‰ç«¯ emoji**: `frontend/services/intimacyConfigService.ts` â†’ `STAGE_EMOJIS`
